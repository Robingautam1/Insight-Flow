<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InsightFlow â€” Data Sources</title>
    <meta name="description" content="Manage your data connections and uploads.">
    <link rel="icon" href="assets/images/favicon.ico" type="image/x-icon">

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <a href="index.html" class="sidebar-logo logo">
                <i data-lucide="activity"></i>
                Insight<span>Flow</span>
            </a>

            <nav class="sidebar-menu">
                <a href="dashboard.html" class="sidebar-item">
                    <i data-lucide="layout-grid"></i>
                    Dashboard
                </a>
                <a href="analytics.html" class="sidebar-item">
                    <i data-lucide="bar-chart-2"></i>
                    Analytics
                </a>
                <a href="data.html" class="sidebar-item active">
                    <i data-lucide="database"></i>
                    Data Sources
                </a>
                <a href="settings.html" class="sidebar-item">
                    <i data-lucide="settings"></i>
                    Settings
                </a>
                <a href="support.html" class="sidebar-item">
                    <i data-lucide="help-circle"></i>
                    Support
                </a>
            </nav>

            <div class="mt-auto">
                <div class="card bg-slate-50 border-none p-4">
                    <h5 class="font-bold mb-1">Pro Plan</h5>
                    <p class="text-xs text-muted mb-2">You have 12 days left in your trial.</p>
                    <button class="btn btn-primary btn-sm w-full text-xs">Upgrade</button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content animate-fade-in relative">
            <!-- Top Bar -->
            <header class="top-bar mb-8">
                <div class="flex items-center gap-4">
                    <button class="mobile-menu-btn lg:hidden" id="sidebar-toggle">
                        <i data-lucide="menu"></i>
                    </button>
                    <div>
                        <h2 class="text-2xl font-bold text-slate-900">Data Sources</h2>
                        <p class="text-slate-500 text-sm">Manage your integrations and file uploads.</p>
                    </div>
                </div>

                <div class="flex items-center gap-6">
                    <div class="user-menu flex items-center gap-4">
                        <button id="themeToggle" class="text-slate-500 hover:text-slate-700 transition-colors">
                            <i data-lucide="moon" size="20"></i>
                        </button>
                        <div
                            class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold border border-indigo-200">
                            JD</div>
                    </div>
                </div>
            </header>

            <!-- Quick Stats Overview -->
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                <div class="card p-4 flex items-center gap-4 shadow-sm">
                    <div class="p-3 rounded-full bg-indigo-50 text-indigo-600">
                        <i data-lucide="link" size="24"></i>
                    </div>
                    <div>
                        <div class="text-2xl font-bold" id="stat-sources">2</div>
                        <div class="text-sm text-muted">Connected Sources</div>
                    </div>
                </div>
                <div class="card p-4 flex items-center gap-4 shadow-sm">
                    <div class="p-3 rounded-full bg-green-50 text-green-600">
                        <i data-lucide="database" size="24"></i>
                    </div>
                    <div>
                        <div class="text-2xl font-bold" id="stat-records">45,234</div>
                        <div class="text-sm text-muted">Records Synced</div>
                    </div>
                </div>
                <div class="card p-4 flex items-center gap-4 shadow-sm">
                    <div class="p-3 rounded-full bg-blue-50 text-blue-600">
                        <i data-lucide="refresh-cw" size="24"></i>
                    </div>
                    <div>
                        <div class="text-2xl font-bold" id="stat-last-sync">10m ago</div>
                        <div class="text-sm text-muted">Last Sync</div>
                    </div>
                </div>
                <div class="card p-4 flex items-center gap-4 shadow-sm">
                    <div class="p-3 rounded-full bg-purple-50 text-purple-600">
                        <i data-lucide="layout-grid" size="24"></i>
                    </div>
                    <div>
                        <div class="text-2xl font-bold">12</div>
                        <div class="text-sm text-muted">Available Integrations</div>
                    </div>
                </div>
            </div>

            <div class="flex flex-col gap-12">

                <!-- Connected Sources Section -->
                <section>
                    <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                        <i data-lucide="check-circle" size="20" class="text-green-500"></i> Active Connections
                    </h3>
                    <div class="grid lg:grid-cols-2 gap-8">

                        <!-- Shopify Card -->
                        <div
                            class="card p-0 overflow-hidden shadow-md hover:shadow-lg transition-shadow group border-l-4 border-l-green-500">
                            <div class="p-6 flex items-start gap-6">
                                <div
                                    class="w-14 h-14 rounded-full bg-green-50 flex items-center justify-center shrink-0">
                                    <i data-lucide="shopping-bag" size="28" class="text-green-600"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex justify-between items-start mb-1">
                                        <h4 class="text-xl font-bold">Shopify Store</h4>
                                        <div class="flex items-center gap-2">
                                            <span
                                                class="inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-50 text-green-700">
                                                <span
                                                    class="w-2 h-2 rounded-full bg-green-500 animate-pulse-green"></span>
                                                Active
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-slate-500 mb-2">
                                        <i data-lucide="clock" size="14"></i> Last synced: <span class="sync-time">Just
                                            now</span>
                                    </div>
                                    <p class="text-sm text-slate-600 mb-1"><strong>2,450</strong> orders synced</p>
                                    <p class="text-xs text-slate-400">Connected on Nov 15, 2024</p>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <button
                                        class="p-2 text-slate-400 hover:text-indigo-600 hover:bg-slate-50 rounded transition-colors"
                                        title="Configure" onclick="toggleSettings('shopify')">
                                        <i data-lucide="settings" size="18"></i>
                                    </button>
                                    <button
                                        class="p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors"
                                        title="Disconnect">
                                        <i data-lucide="trash-2" size="18"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Sync Progress -->
                            <div
                                class="bg-slate-50 px-6 py-3 border-t border-slate-100 flex items-center justify-between text-xs">
                                <span class="text-slate-500 font-medium">Sync Status: <span
                                        class="text-green-600">Success</span></span>
                                <div class="w-32 h-1.5 bg-slate-200 rounded-full overflow-hidden">
                                    <div class="h-full bg-green-500 w-full"></div>
                                </div>
                            </div>

                            <!-- Settings Panel (Collapsible) -->
                            <div id="settings-shopify"
                                class="hidden bg-slate-50 border-t border-slate-200 p-6 animate-fade-in">
                                <h5 class="font-bold text-sm mb-4">Sync Configuration</h5>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-xs font-medium text-slate-500 mb-2">Sync
                                            Frequency</label>
                                        <div class="flex gap-4">
                                            <label class="inline-flex items-center gap-2 text-sm cursor-pointer"><input
                                                    type="radio" name="freq-shop" checked> Real-time</label>
                                            <label class="inline-flex items-center gap-2 text-sm cursor-pointer"><input
                                                    type="radio" name="freq-shop"> Hourly</label>
                                            <label class="inline-flex items-center gap-2 text-sm cursor-pointer"><input
                                                    type="radio" name="freq-shop"> Daily</label>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-slate-500 mb-2">Data
                                            Filters</label>
                                        <div class="flex flex-wrap gap-4">
                                            <label class="inline-flex items-center gap-2 text-sm"><input type="checkbox"
                                                    checked> Orders</label>
                                            <label class="inline-flex items-center gap-2 text-sm"><input type="checkbox"
                                                    checked> Customers</label>
                                            <label class="inline-flex items-center gap-2 text-sm"><input type="checkbox"
                                                    checked> Inventory</label>
                                        </div>
                                    </div>
                                    <div class="pt-4 flex justify-end">
                                        <button class="btn btn-sm btn-primary" onclick="toggleSettings('shopify')">Save
                                            Changes</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Stripe Card -->
                        <div
                            class="card p-0 overflow-hidden shadow-md hover:shadow-lg transition-shadow group border-l-4 border-l-indigo-500">
                            <div class="p-6 flex items-start gap-6">
                                <div
                                    class="w-14 h-14 rounded-full bg-indigo-50 flex items-center justify-center shrink-0">
                                    <i data-lucide="credit-card" size="28" class="text-indigo-600"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex justify-between items-start mb-1">
                                        <h4 class="text-xl font-bold">Stripe Payments</h4>
                                        <div class="flex items-center gap-2">
                                            <span
                                                class="inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-50 text-green-700">
                                                <span
                                                    class="w-2 h-2 rounded-full bg-green-500 animate-pulse-green"></span>
                                                Active
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-slate-500 mb-2">
                                        <i data-lucide="clock" size="14"></i> Last synced: <span class="sync-time">1 hr
                                            ago</span>
                                    </div>
                                    <p class="text-sm text-slate-600 mb-1"><strong>156</strong> transactions this month
                                    </p>
                                    <p class="text-xs text-slate-400">Connected on Dec 01, 2024</p>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <button
                                        class="p-2 text-slate-400 hover:text-indigo-600 hover:bg-slate-50 rounded transition-colors"
                                        title="Configure">
                                        <i data-lucide="settings" size="18"></i>
                                    </button>
                                    <button
                                        class="p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors"
                                        title="Disconnect">
                                        <i data-lucide="trash-2" size="18"></i>
                                    </button>
                                </div>
                            </div>
                            <!-- Sync Progress -->
                            <div
                                class="bg-slate-50 px-6 py-3 border-t border-slate-100 flex items-center justify-between text-xs">
                                <span class="text-slate-500 font-medium">Sync Status: <span
                                        class="text-indigo-600">Checking...</span></span>
                                <div class="w-32 h-1.5 bg-slate-200 rounded-full overflow-hidden">
                                    <div class="h-full bg-indigo-500 w-[60%] animate-pulse"></div>
                                </div>
                            </div>
                        </div>

                    </div>
                </section>

                <!-- Available Integrations -->
                <section>
                    <div class="flex flex-col md:flex-row justify-between items-end md:items-center gap-4 mb-6">
                        <h3 class="text-lg font-bold flex items-center gap-2">
                            <i data-lucide="plus-circle" size="20" class="text-indigo-500"></i> Available Integrations
                        </h3>
                        <!-- Search & Filter -->
                        <div class="flex flex-wrap gap-3">
                            <div class="relative">
                                <i data-lucide="search" size="16"
                                    class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                                <input type="text" id="integration-search" placeholder="Search apps..."
                                    class="pl-9 pr-4 py-2 rounded-lg border border-slate-200 text-sm focus:outline-none focus:border-indigo-500 w-full sm:w-64">
                            </div>
                            <select id="category-filter"
                                class="px-4 py-2 rounded-lg border border-slate-200 text-sm focus:outline-none focus:border-indigo-500 bg-white cursor-pointer">
                                <option value="all">All Categories</option>
                                <option value="marketing">Marketing</option>
                                <option value="sales">Sales</option>
                                <option value="finance">Finance</option>
                                <option value="ecommerce">E-commerce</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
                        id="integrations-grid">
                        <!-- Integrations generated by JS -->
                    </div>
                </section>

                <!-- File Upload & Recent -->
                <section class="grid lg:grid-cols-3 gap-8">
                    <!-- Upload Zone -->
                    <div class="lg:col-span-1">
                        <h3 class="text-lg font-bold mb-4">Manual Import</h3>
                        <div class="border-2 border-dashed border-indigo-300 rounded-xl bg-indigo-50/50 hover:bg-indigo-50 transition-all p-8 flex flex-col items-center justify-center text-center cursor-pointer h-80 relative group"
                            id="drop-zone">
                            <input type="file" id="file-input" class="absolute inset-0 opacity-0 cursor-pointer z-10">
                            <div
                                class="w-16 h-16 bg-white rounded-full shadow-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
                                <i data-lucide="cloud-upload" size="32" class="text-indigo-600"></i>
                            </div>
                            <h4 class="text-xl font-bold text-slate-800 mb-2">Drag & drop files here</h4>
                            <p class="text-sm text-slate-500 mb-4">or click to browse from your computer</p>
                            <div
                                class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white border border-slate-200 text-xs text-slate-400">
                                <span>CSV, XLSX</span>
                                <span class="w-1 h-1 rounded-full bg-slate-300"></span>
                                <span>Max 10MB</span>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Uploads Table -->
                    <div class="lg:col-span-2">
                        <h3 class="text-lg font-bold mb-4">Recent Uploads</h3>
                        <div class="card p-0 overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full text-left text-sm">
                                    <thead class="bg-slate-50 border-b border-slate-200 text-slate-500">
                                        <tr>
                                            <th class="px-6 py-4 font-medium">File Name</th>
                                            <th class="px-6 py-4 font-medium">Date</th>
                                            <th class="px-6 py-4 font-medium">Records</th>
                                            <th class="px-6 py-4 font-medium">Status</th>
                                            <th class="px-6 py-4 text-right font-medium">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-slate-100" id="uploads-table-body">
                                        <!-- Populated via JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Integration Details Modal -->
    <div id="integration-modal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-slate-900/50 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
        <div class="absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-2xl transform translate-x-full transition-transform duration-300 ease-out flex flex-col"
            id="modal-panel">
            <!-- Modal Header -->
            <div class="p-6 border-b border-slate-100 flex items-center justify-between bg-slate-50/50">
                <div class="flex items-center gap-4">
                    <div id="modal-icon-container"
                        class="w-12 h-12 rounded-xl bg-white shadow-sm flex items-center justify-center border border-slate-100">
                        <!-- Icon -->
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-slate-900" id="modal-title">Integration Name</h3>
                        <p class="text-xs text-slate-500" id="modal-category">Category</p>
                    </div>
                </div>
                <button onclick="closeModal()"
                    class="p-2 text-slate-400 hover:text-slate-600 rounded-full hover:bg-slate-100 transition-colors">
                    <i data-lucide="x" size="20"></i>
                </button>
            </div>

            <!-- Modal Body -->
            <div class="flex-1 overflow-y-auto p-6 space-y-8">
                <div>
                    <h4 class="font-bold text-sm mb-2">What handles this integration?</h4>
                    <p class="text-sm text-slate-600 leading-relaxed" id="modal-desc">Sync your data automatically.</p>
                </div>

                <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
                    <h5 class="flex items-center gap-2 text-blue-800 font-bold text-sm mb-3">
                        <i data-lucide="shield-check" size="16"></i> Data Permissions
                    </h5>
                    <ul class="space-y-2">
                        <li class="flex items-start gap-2 text-xs text-blue-700">
                            <i data-lucide="check" size="14" class="mt-0.5 shrink-0"></i> Read customer details
                        </li>
                        <li class="flex items-start gap-2 text-xs text-blue-700">
                            <i data-lucide="check" size="14" class="mt-0.5 shrink-0"></i> Read product inventory
                        </li>
                        <li class="flex items-start gap-2 text-xs text-blue-700">
                            <i data-lucide="check" size="14" class="mt-0.5 shrink-0"></i> Read order history
                        </li>
                    </ul>
                </div>

                <div class="border-t border-slate-100 pt-6">
                    <h4 class="font-bold text-sm mb-4">Configuration Step</h4>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-3 border border-slate-200 rounded-lg">
                            <span class="text-sm font-medium">Sync Frequency</span>
                            <select
                                class="text-sm border-none bg-transparent font-bold text-indigo-600 focus:outline-none cursor-pointer">
                                <option>Real-time</option>
                                <option>Hourly</option>
                                <option>Daily</option>
                            </select>
                        </div>
                        <div class="flex items-center justify-between p-3 border border-slate-200 rounded-lg">
                            <span class="text-sm font-medium">Historical Data</span>
                            <select
                                class="text-sm border-none bg-transparent font-bold text-indigo-600 focus:outline-none cursor-pointer">
                                <option>Last 30 Days</option>
                                <option>Last 1 Year</option>
                                <option>All Time</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-6 border-t border-slate-100 bg-slate-50 flex gap-4">
                <button onclick="closeModal()"
                    class="flex-1 btn bg-white border border-slate-200 text-slate-600 hover:bg-slate-50">Cancel</button>
                <button onclick="connectIntegration()" class="flex-1 btn btn-primary shadow-lg shadow-indigo-200"
                    id="modal-connect-btn">Connect Now</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/data.js"></script>
    <script src="js/main.js"></script>
    <script>
        lucide.createIcons();

        // --- Data & State ---
        const integrations = [
            { id: 'fb', name: 'Facebook Ads', category: 'marketing', icon: 'facebook', desc: 'Import ad spend, clicks, and conversion data directly to your dashboard.' },
            { id: 'ig', name: 'Instagram', category: 'marketing', icon: 'instagram', desc: 'Track follower growth, engagement rates, and social commerce metrics.' },
            { id: 'mc', name: 'Mailchimp', category: 'marketing', icon: 'mail', desc: 'Sync email campaign stats, subscriber lists, and open rates.' },
            { id: 'ga', name: 'Google Analytics', category: 'marketing', icon: 'bar-chart-3', desc: 'Bring web traffic, user behavior, and session data into your reports.' },
            { id: 'hs', name: 'HubSpot', category: 'sales', icon: 'users', desc: 'Sync leads, deals, and pipeline stages for better sales forecasting.' },
            { id: 'qb', name: 'QuickBooks', category: 'finance', icon: 'file-text', desc: 'Automate financial reporting with real-time expense and revenue sync.' },
            { id: 'pp', name: 'PayPal', category: 'finance', icon: 'wallet', desc: 'Track transaction fees, refunds, and net revenue across all currencies.' },
            { id: 'sf', name: 'Salesforce', category: 'sales', icon: 'cloud', desc: 'Deep dive into CRM data with advanced segmentation and quota tracking.' },
            { id: 'sl', name: 'Slack', category: 'marketing', icon: 'message-square', desc: 'Receive daily digests and real-time alerts in your team channels.' },
            { id: 'zp', name: 'Zapier', category: 'productivity', icon: 'zap', desc: 'Connect to 5,000+ apps and automate custom workflows effortlessly.' },
            { id: 'wc', name: 'WooCommerce', category: 'ecommerce', icon: 'shopping-bag', desc: 'Sync products, orders, and customers from your WordPress store.' },
            { id: 'am', name: 'Amazon Seller', category: 'ecommerce', icon: 'package', desc: 'Track FBA inventory, sales velocity, and buy box performance.' }
        ];

        const recentUploads = [
            { name: 'sales_data_dec.csv', date: '2 hours ago', rows: '1,234', status: 'Processed' },
            { name: 'customer_list.xlsx', date: '1 day ago', rows: '856', status: 'Processed' },
            { name: 'transactions_nov.csv', date: '3 days ago', rows: '3,421', status: 'Processed' },
            { name: 'inventory.xlsx', date: '5 days ago', rows: '567', status: 'Processing' },
            { name: 'returns_data.csv', date: '1 week ago', rows: '89', status: 'Failed' }
        ];

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            renderIntegrations();
            renderUploads();
            initFilters();
            initUploadZone();
            startSimulations();
        });

        // --- Render Functions ---
        function renderIntegrations(filter = '', category = 'all') {
            const grid = document.getElementById('integrations-grid');
            grid.innerHTML = '';

            const filtered = integrations.filter(item => {
                const matchesSearch = item.name.toLowerCase().includes(filter.toLowerCase());
                const matchesCat = category === 'all' || item.category === category;
                return matchesSearch && matchesCat;
            });

            filtered.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card p-6 hover:-translate-y-1 hover:shadow-xl transition-all duration-300 group';
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-16 h-16 rounded-2xl bg-slate-50 flex items-center justify-center group-hover:bg-indigo-50 transition-colors">
                            <i data-lucide="${item.icon}" size="32" class="text-slate-600 group-hover:text-indigo-600 transition-colors"></i>
                        </div>
                        <span class="text-xs font-bold text-slate-400 uppercase tracking-wider border border-slate-200 px-2 py-1 rounded">${item.category.substr(0, 4)}</span>
                    </div>
                    <h4 class="font-bold text-lg mb-2 text-slate-900">${item.name}</h4>
                    <p class="text-sm text-slate-500 mb-6 h-10 overflow-hidden text-ellipsis line-clamp-2">${item.desc}</p>
                    <div class="flex items-center gap-2 mb-6">
                         <div class="flex -space-x-2">
                             <div class="w-6 h-6 rounded-full bg-slate-200 border-2 border-white"></div>
                             <div class="w-6 h-6 rounded-full bg-slate-300 border-2 border-white"></div>
                             <div class="w-6 h-6 rounded-full bg-slate-400 border-2 border-white"></div>
                         </div>
                         <span class="text-xs text-slate-400 font-medium">Used by 10k+</span>
                    </div>
                    <button class="btn btn-outline-primary w-full group-hover:bg-indigo-600 group-hover:text-white group-hover:border-indigo-600 transition-all" onclick="openModal('${item.id}')">Connect</button>
                `;
                grid.appendChild(card);
            });
            lucide.createIcons();
        }

        function renderUploads() {
            const tbody = document.getElementById('uploads-table-body');
            tbody.innerHTML = recentUploads.map(file => {
                let statusClass = 'bg-green-100 text-green-700'; // Success
                if (file.status === 'Processing') statusClass = 'bg-blue-100 text-blue-700 animate-pulse';
                if (file.status === 'Failed') statusClass = 'bg-red-100 text-red-700';

                return `
                    <tr class="hover:bg-slate-50 transition-colors group">
                        <td class="px-6 py-4 flex items-center gap-3">
                             <div class="p-2 bg-slate-100 rounded text-slate-500"><i data-lucide="file-text" size="18"></i></div>
                             <span class="font-medium text-slate-700">${file.name}</span>
                        </td>
                        <td class="px-6 py-4 text-slate-500">${file.date}</td>
                        <td class="px-6 py-4 text-slate-500 font-mono text-xs">${file.rows}</td>
                        <td class="px-6 py-4">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusClass}">
                                ${file.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 text-right">
                             <div class="flex items-center justify-end gap-2 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity">
                                 <button class="p-1 hover:text-indigo-600"><i data-lucide="eye" size="16"></i></button>
                                 <button class="p-1 hover:text-indigo-600"><i data-lucide="download" size="16"></i></button>
                                 <button class="p-1 hover:text-red-500"><i data-lucide="trash-2" size="16"></i></button>
                             </div>
                        </td>
                    </tr>
                `;
            }).join('');
            lucide.createIcons();
        }

        function initFilters() {
            const search = document.getElementById('integration-search');
            const cat = document.getElementById('category-filter');

            const handleFilter = () => {
                renderIntegrations(search.value, cat.value);
            };

            search.addEventListener('input', handleFilter);
            cat.addEventListener('change', handleFilter);
        }

        // --- Drag & Drop Upload Zone ---
        function initUploadZone() {
            const zone = document.getElementById('drop-zone');
            const input = document.getElementById('file-input');

            zone.addEventListener('dragover', (e) => {
                e.preventDefault();
                zone.classList.add('bg-indigo-100', 'border-indigo-500');
            });

            zone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                zone.classList.remove('bg-indigo-100', 'border-indigo-500');
            });

            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.classList.remove('bg-indigo-100', 'border-indigo-500');
                if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
            });

            input.addEventListener('change', (e) => {
                if (e.target.files.length) handleFile(e.target.files[0]);
            });
        }

        function handleFile(file) {
            // Simulate Upload
            const rowStub = {
                name: file.name,
                date: 'Just now',
                rows: 'Evaluating...',
                status: 'Processing'
            };
            recentUploads.unshift(rowStub);
            renderUploads();

            // Simulate finish
            setTimeout(() => {
                recentUploads[0].status = 'Processed';
                recentUploads[0].rows = Math.floor(Math.random() * 5000) + ' rows';
                document.getElementById('stat-records').innerText = parseInt(document.getElementById('stat-records').innerText.replace(',', '')) + parseInt(recentUploads[0].rows);

                // Show toast
                alert(`File "${file.name}" uploaded successfully!`);
                renderUploads();
            }, 2000);
        }

        // --- Modal Logic ---
        const modal = document.getElementById('integration-modal');
        const modalPanel = document.getElementById('modal-panel');

        function openModal(id) {
            const data = integrations.find(i => i.id === id);
            if (!data) return;

            document.getElementById('modal-title').innerText = data.name;
            document.getElementById('modal-category').innerText = data.category.toUpperCase();
            document.getElementById('modal-desc').innerText = data.desc;
            document.getElementById('modal-icon-container').innerHTML = `<i data-lucide="${data.icon}" size="24" class="text-indigo-600"></i>`;

            modal.classList.remove('hidden');
            setTimeout(() => {
                modalPanel.classList.remove('translate-x-full');
            }, 10);

            lucide.createIcons();
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            modalPanel.classList.add('translate-x-full');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
            document.body.style.overflow = '';
        }

        function connectIntegration() {
            const btn = document.getElementById('modal-connect-btn');
            const originalText = btn.innerText;
            btn.innerHTML = '<i data-lucide="loader-2" class="animate-spin" size="18"></i> Connecting...';
            lucide.createIcons();

            setTimeout(() => {
                btn.innerHTML = '<i data-lucide="check" size="18"></i> Connected!';
                btn.classList.remove('btn-primary');
                btn.classList.add('bg-green-500', 'text-white', 'border-transparent');
                lucide.createIcons();

                setTimeout(() => {
                    closeModal();
                    // Reset btn state for next time
                    setTimeout(() => {
                        btn.innerHTML = originalText;
                        btn.className = 'flex-1 btn btn-primary shadow-lg shadow-indigo-200';
                    }, 500);
                    alert("Integration connected successfully!");
                }, 1000);
            }, 2000);
        }

        // --- Settings Toggle ---
        window.toggleSettings = function (id) {
            const panel = document.getElementById(`settings-${id}`);
            if (panel) {
                if (panel.classList.contains('hidden')) {
                    panel.classList.remove('hidden');
                } else {
                    panel.classList.add('hidden');
                }
            }
        }

        // --- Simulations ---
        function startSimulations() {
            // Update time
            setInterval(() => {
                document.querySelectorAll('.sync-time').forEach(el => {
                    el.innerText = 'Just now';
                    setTimeout(() => el.innerText = '1 min ago', 55000);
                });

                // Randomly pulse last sync stat
                const stat = document.getElementById('stat-last-sync');
                if (stat) stat.innerText = 'Just now';
            }, 60000); // every minute
        }

    </script>
</body>

</html>